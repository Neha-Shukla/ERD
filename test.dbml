Project "E-Commerce" {
  database_type: 'PostgreSQL'
  Note: 'A sample complex DBML for testing'
}

Table users {
  id int [pk, increment]
  username varchar [unique, not null]
  email varchar [unique, not null]
  profile_id int [unique] // one-to-one with profiles
}

Table profiles {
  id int [pk, increment]
  full_name varchar
  address text
  phone varchar
}

Table products {
  id int [pk, increment]
  name varchar [not null]
  price decimal [not null]
  category_id int
}

Table categories {
  id int [pk, increment]
  name varchar [not null]
}

Table orders {
  id int [pk, increment]
  user_id int [not null]
  order_date datetime [default: `now()`]
  status varchar [default: 'pending']
}

Table order_items {
  id int [pk, increment]
  order_id int [not null]
  product_id int [not null]
  quantity int [not null]
  price decimal [not null]
}

Table tags {
  id int [pk, increment]
  name varchar [not null, unique]
}

Table product_tags {
  product_id int [not null]
  tag_id int [not null]
  Note: 'Join table for many-to-many between products and tags'
}

Ref: users.profile_id - profiles.id        // one-to-one
Ref: orders.user_id > users.id             // many-to-one (*..1)
Ref: order_items.order_id > orders.id      // many-to-one (*..1)
Ref: order_items.product_id > products.id  // many-to-one (*..1)
Ref: products.category_id > categories.id  // many-to-one (*..1)
Ref: product_tags.product_id > products.id // many-to-one
Ref: product_tags.tag_id > tags.id         // many-to-one
